<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.57 in css mode. -->
<html>
  <head>
    <title>2022-0927-2.org</title>
    <style type="text/css">
    <!--
      body {
        color: #ffffd9;
        background-color: #000b00;
      }
      .comment {
        /* font-lock-comment-face */
        color: #f0908d;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #ffd900;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #f39800;
      }
      .org-block {
        /* org-block */
        color: #b3b3b3;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #f0908d;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #f0908d;
      }
      .org-date {
        /* org-date */
        color: #00ffff;
        text-decoration: underline;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #ffd900;
      }
      .org-tag {
        /* org-tag */
        font-weight: bold;
      }
      .rainbow-delimiters-depth-1 {
        /* rainbow-delimiters-depth-1-face */
        color: #ec6d71;
      }
      .rainbow-delimiters-depth-2 {
        /* rainbow-delimiters-depth-2-face */
        color: #f6bfbc;
      }
      .rainbow-delimiters-depth-3 {
        /* rainbow-delimiters-depth-3-face */
        color: #f6ad49;
      }
      .rainbow-delimiters-depth-4 {
        /* rainbow-delimiters-depth-4-face */
        color: #ffec47;
      }
      .rainbow-delimiters-depth-5 {
        /* rainbow-delimiters-depth-5-face */
        color: #68be8d;
      }
      .rainbow-delimiters-depth-6 {
        /* rainbow-delimiters-depth-6-face */
        color: #478384;
      }
      .rainbow-delimiters-depth-7 {
        /* rainbow-delimiters-depth-7-face */
        color: #a0d8ef;
      }
      .rainbow-delimiters-depth-8 {
        /* rainbow-delimiters-depth-8-face */
        color: #aa4c8f;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="org-level-1">* </span><span class="org-date">[2022-09-27 &#28779;]</span><span class="org-level-1"> common lisp&#12391;&#12398;&#25991;&#23383;&#21015;&#32622;&#25563;2 </span><span class="org-level-1"><span class="org-tag">:lisp:</span></span>

&#12394;&#12435;&#12363;&#26356;&#26032;&#12364;&#28382;&#12387;&#12390;&#12356;&#12427;&#12290;&#12392;&#12426;&#12354;&#12360;&#12378;&#12371;&#12398;&#12502;&#12525;&#12464;&#12398;&#26041;&#37341;&#12394;&#12393;&#12395;
&#12388;&#12356;&#12390;&#12399;&#20316;&#12426;&#12394;&#12364;&#12425;&#32771;&#12360;&#12424;&#12358;&#12392;&#24605;&#12387;&#12390;&#12356;&#12383;&#12369;&#12393;&#12289;
&#25244;&#32676;&#12395;SEO&#23550;&#31574;&#12364;&#12394;&#12387;&#12390;&#12356;&#12394;&#12356;&#31505;
google&#12398;&#12394;&#12435;&#12392;&#12363;&#12387;&#12390;&#12398;&#12434;&#12385;&#12423;&#12387;&#12392;&#35373;&#23450;&#12399;&#12375;&#12383;&#12399;&#12378;&#12394;&#12435;&#12384;&#12369;&#12393;&#12290;
&#12414;&#12353;&#12289;&#12354;&#12427;&#24847;&#21619;&#38560;&#12428;&#23478;&#12415;&#12383;&#12356;&#12394;&#12418;&#12435;&#12363;&#31505;

&#12354;&#12392;&#20491;&#20154;&#12502;&#12525;&#12464;&#12395;&#12375;&#12383;&#12435;&#12384;&#12363;&#12425;lisp&#12395;&#38480;&#12425;&#12378;&#22909;&#12365;&#12394;&#20107;&#12434;
&#26360;&#12356;&#12390;&#12356;&#12365;&#12383;&#12356;&#12435;&#12384;&#12369;&#12393;&#12289;&#12385;&#12423;&#12387;&#12392;&#29694;&#27573;&#38542;&#12391;&#12399;&#12414;&#12384;&#12381;&#12358;&#12356;&#12358;&#12398;&#12364;&#20986;&#26469;&#12390;&#12394;&#12356;&#12290;
&#12488;&#12483;&#12503;&#12506;&#12540;&#12472;&#12364;&#12418;&#12358;&#12460;&#12481;&#12395;lisp&#12387;&#12390;&#24863;&#12376;&#12384;&#12375;&#12290;

&#12414;&#12353;&#12289;&#12381;&#12358;&#12356;&#12358;&#20107;&#12399;&#20170;&#12399;&#12414;&#12384;&#12356;&#12356;&#12392;&#12375;&#12390;&#20170;&#26085;&#12398;&#12362;&#38988;&#12399;
&#12371;&#12398;&#21069;&#12398;&#25991;&#23383;&#21015;&#32622;&#25563;&#12364;&#32080;&#23616;&#12456;&#12521;&#12540;&#12364;&#20986;&#12383;&#12398;&#12391;&#20316;&#12426;&#30452;&#12375;&#12383;&#12392;&#12356;&#12358;&#35441;&#12290;
&#12392;&#12426;&#12354;&#12360;&#12378;&#12289;&#21069;&#22238;&#20316;&#12387;&#12383;&#12418;&#12398;&#12399;&#12371;&#12428;&#12290;

<span class="org-block-begin-line">#+BEGIN_SRC lisp
</span><span class="org-block">  </span><span class="org-block"><span class="rainbow-delimiters-depth-1">(</span></span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">scan</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block">key obj</span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block">
    </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">key-len </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">length key</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block">
          </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">start </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">search key obj</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block">
      </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block">values start </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">+ start key-len</span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-1">)</span></span><span class="org-block">  </span><span class="org-block"><span class="comment">; =&gt;SCAN 
</span></span><span class="org-block-end-line">#+END_SRC
</span>
<span class="org-block-begin-line">#+BEGIN_SRC lisp
</span><span class="org-block">  </span><span class="org-block"><span class="rainbow-delimiters-depth-1">(</span></span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">%s</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block">old new obj</span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block">
    </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">old-len </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">length old</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block"> 
          </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">start </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">search old obj</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block"> 
      </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block">concatenate 'string </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">subseq obj 0 start</span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block"> new
                   </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block"><span class="rainbow-delimiters-depth-6">(</span></span><span class="org-block">rest </span><span class="org-block"><span class="rainbow-delimiters-depth-7">(</span></span><span class="org-block">subseq obj </span><span class="org-block"><span class="rainbow-delimiters-depth-8">(</span></span><span class="org-block">+ start old-len</span><span class="org-block"><span class="rainbow-delimiters-depth-8">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-7">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-6">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block">
                     </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-6">(</span></span><span class="org-block">&lt; old-len </span><span class="org-block"><span class="rainbow-delimiters-depth-7">(</span></span><span class="org-block">length rest</span><span class="org-block"><span class="rainbow-delimiters-depth-7">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-6">)</span></span><span class="org-block">
                         </span><span class="org-block"><span class="rainbow-delimiters-depth-6">(</span></span><span class="org-block">%s old new rest</span><span class="org-block"><span class="rainbow-delimiters-depth-6">)</span></span><span class="org-block">
                         rest</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-1">)</span></span><span class="org-block">        </span><span class="org-block"><span class="comment">; =&gt;%S 
</span></span><span class="org-block-end-line">#+END_SRC
</span>
&#65297;&#12388;&#12395;scan&#12418;%s&#12418;&#12480;&#12502;&#12426;&#12364;&#22810;&#12356;&#12392;&#12356;&#12358;&#20107;&#12290;
&#12392;&#12356;&#12358;&#20107;&#12391;&#12289;scan&#12434;&#27963;&#12363;&#12375;&#12390;&#12289;%s&#12434;&#20316;&#12426;&#30452;&#12375;&#12390;&#12415;&#12383;&#12290;

&#12456;&#12521;&#12540;&#12364;&#20986;&#12383;&#21407;&#22240;&#12384;&#12364;&#12289;%s&#12398;&#20966;&#29702;&#12391;&#12461;&#12540;&#12527;&#12540;&#12489;&#12398;&#38263;&#12373;&#12424;&#12426;&#30701;&#12367;&#12394;&#12387;&#12383;&#12425;
object&#12398;&#27531;&#12426;&#12434;&#36820;&#12377;&#20966;&#29702;&#12434;&#12375;&#12390;&#12356;&#12427;&#12364;&#12289;&#12461;&#12540;&#12527;&#12540;&#12489;&#12398;&#38263;&#12373;&#12424;&#12426;
&#12414;&#12384;&#27531;&#12387;&#12390;&#12356;&#12427;&#12398;&#12395;&#12289;&#12418;&#12358;&#12461;&#12540;&#12527;&#12540;&#12489;&#12364;object&#20869;&#12395;&#35211;&#24403;&#12383;&#12425;&#12394;&#12356;&#26178;&#12395;
&#12456;&#12521;&#12540;&#12364;&#30330;&#29983;&#12375;&#12390;&#12356;&#12383;&#12290;

&#12354;&#12392;&#12289;obj&#12364;nil&#12398;&#26178;&#12418;&#12456;&#12521;&#12540;&#12364;&#30330;&#29983;&#12375;&#12390;&#12356;&#12383;&#12290;

&#12381;&#12358;&#12356;&#12387;&#12383;&#35576;&#12293;&#12398;&#20107;&#12434;&#35299;&#27770;&#12375;&#12390;&#12415;&#12383;&#12398;&#12364;&#12289;&#12371;&#12428;&#12290;

<span class="org-block-begin-line">#+BEGIN_SRC lisp
</span><span class="org-block">  </span><span class="org-block"><span class="rainbow-delimiters-depth-1">(</span></span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">scan</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block">key obj</span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block">
    </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block"><span class="keyword">let*</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">key-len </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">length key</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block">
           </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">result </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">search key obj</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block">
          </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">start </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block"><span class="keyword">when</span></span><span class="org-block"> result result</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block">
      </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> start
          </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">values start </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">+ start key-len</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block">
          nil</span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-1">)</span></span><span class="org-block">                          </span><span class="org-block"><span class="comment">; =&gt;SCAN 
</span></span><span class="org-block">
  </span><span class="org-block"><span class="rainbow-delimiters-depth-1">(</span></span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">%s</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block">old new obj</span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block">
    </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block"><span class="keyword">multiple-value-bind</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block">start end</span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block">
        </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block">scan old obj</span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block">
      </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> start
          </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block"><span class="keyword">let*</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block"><span class="rainbow-delimiters-depth-6">(</span></span><span class="org-block">rest </span><span class="org-block"><span class="rainbow-delimiters-depth-7">(</span></span><span class="org-block">subseq obj end</span><span class="org-block"><span class="rainbow-delimiters-depth-7">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-6">)</span></span><span class="org-block">
                 </span><span class="org-block"><span class="rainbow-delimiters-depth-6">(</span></span><span class="org-block">result </span><span class="org-block"><span class="rainbow-delimiters-depth-7">(</span></span><span class="org-block">%s old new rest</span><span class="org-block"><span class="rainbow-delimiters-depth-7">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-6">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block">
            </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">concatenate 'string </span><span class="org-block"><span class="rainbow-delimiters-depth-6">(</span></span><span class="org-block">subseq obj 0 start</span><span class="org-block"><span class="rainbow-delimiters-depth-6">)</span></span><span class="org-block"> new result</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block">
          obj</span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-1">)</span></span><span class="org-block">                          </span><span class="org-block"><span class="comment">; =&gt;%S
</span></span><span class="org-block-end-line">#+END_SRC
</span>
&#12392;&#12371;&#12371;&#12414;&#12391;&#26360;&#12356;&#12390;&#12289;&#12385;&#12423;&#12387;&#12392;scan&#12398;&#20966;&#29702;&#12364;&#20887;&#38263;&#12376;&#12419;&#12394;&#12356;&#12363;&#65311;&#12392;
&#24605;&#12387;&#12390;&#27425;&#12395;&#35330;&#27491;&#12290;

<span class="org-block-begin-line">#+BEGIN_SRC lisp
</span><span class="org-block">  </span><span class="org-block"><span class="rainbow-delimiters-depth-1">(</span></span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">scan</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block">key obj</span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block">
    </span><span class="org-block"><span class="rainbow-delimiters-depth-2">(</span></span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">key-len </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">length key</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block">
           </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">start </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">search key obj</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block">
      </span><span class="org-block"><span class="rainbow-delimiters-depth-3">(</span></span><span class="org-block"><span class="keyword">when</span></span><span class="org-block"> start
          </span><span class="org-block"><span class="rainbow-delimiters-depth-4">(</span></span><span class="org-block">values start </span><span class="org-block"><span class="rainbow-delimiters-depth-5">(</span></span><span class="org-block">+ start key-len</span><span class="org-block"><span class="rainbow-delimiters-depth-5">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-4">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-3">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-2">)</span></span><span class="org-block"><span class="rainbow-delimiters-depth-1">)</span></span><span class="org-block"> </span><span class="org-block"><span class="comment">; =&gt;SCAN 
</span></span><span class="org-block-end-line">#+END_SRC
</span>
&#12392;&#12356;&#12358;&#20107;&#12391;&#12522;&#12501;&#12449;&#12463;&#12479;&#12522;&#12531;&#12464;&#12496;&#12540;&#12472;&#12519;&#12531;&#12399;&#12488;&#12540;&#12479;&#12523;&#12391;&#12356;&#12358;&#12392;&#12289;
&#65297;&#34892;&#12503;&#12521;&#12473;&#12363;&#12290;

&#12354;&#12392;%s&#12395;&#38306;&#12375;&#12390;&#12399;&#24120;&#12395;scan&#12392;&#12475;&#12483;&#12488;&#12391;&#20351;&#12431;&#12394;&#12356;&#12392;&#12356;&#12369;&#12394;&#12356;&#12387;&#12390;
&#32283;&#12426;&#12399;&#20986;&#26469;&#12383;&#12363;&#12394;&#12290;
</pre>
  </body>
</html>
